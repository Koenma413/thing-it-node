<div ui-content-for="topbar">
    <div class="navbar-brand navbar-brand-center">
        <i class="icon sl-router"></i> {{mobileConsole.topPage().node.label}}
    </div>
    <div class="btn-group pull-right">
        <div class="btn">
            <a ng-hide="mobileConsole.speech.active" ng-click="mobileConsole.popPage()"><i
                    class="icon sl-microphone-2"></i></a>
            <a ng-show="mobileConsole.speech.active" ng-click="mobileConsole.speech.deactivate()"><i
                    class="fa fa-microphone-slash"></i></a>
        </div>
        <div ui-toggle="uiSidebarRight" class="btn">
            <i class="icon sl-list-1"></i>
        </div>
    </div>
    <div class="btn-group pull-left">
        <div class="btn">
            <a ng-show="mobileConsole.consoleService.settings.server == 'local'" ng-click="mobileConsole.logout()"><i
                    class="icon sl-power-1"></i></a>
            <a ng-hide="mobileConsole.consoleService.settings.server == 'local'" ng-click="mobileConsole.popPage()">
                <i class="icon sl-arrow-59"></i>
            </a>
        </div>
    </div>
    <ti-color-bar></ti-color-bar>
</div>
<div class="scrollable" ui-state="searchBar">
    <div class="scrollable-content" ui-scroll-bottom='bottomReached()' ui-swipe-right="mobileConsole.popPage()">
        <div class="list-group">
            <div class="list-group-item" style="display: table; border: none !important; width: 100%;"
                 ng-show="mobileConsole.topPage().node.devices.length == 0">
                <div style="display: table-row;">
                    <div style="display: table-cell; text-align: center; padding-top: 3em;">
                        No Devices configured. Click to configure.
                    </div>
                </div>
                <div style="display: table-row;">
                    <div style="display: table-cell; text-align: center;">
                        <a ng-click="mobileConsole.pushDevicesConfigurationPage()">
                            <i class="icon sl-router lightenedPrimaryColor" style="font-size: 4em;"></i></a>
                    </div>
                </div>
            </div>
            <a ng-repeat="group in mobileConsole.topPage().node.groups" ng-click="mobileConsole.pushGroupPage(group)"
               class="list-group-item">
                <span ng-show="group.icon"><i
                        class="{{group.icon}} navigationIcon"></i></span><span
                    ng-hide="group.icon"><i class="titleIcon fa fa-home"></i></span> {{group.label}} <i
                    class="icon sl-arrow-60 pull-right navigationIcon"></i>
            </a>
            <a ng-repeat="service in mobileConsole.topPage().node.services" class="list-group-item"
               ng-click="mobileConsole.callNodeService(mobileConsole.topPage().node, service)">
                <div ng-show="service.type != 'storyboard'">
                    <i class="icon sl-setting-gear navigationIcon"></i> {{service.label}}<i
                        class="icon sl-arrow-60 pull-right navigationIcon"></i></div>
                <div ng-show="service.type == 'storyboard'">
                    <table>
                        <tr>
                            <td><i class="icon sl-setting-gear navigationIcon"></i></td>
                            <td style="padding-left: 3px;">{{service.label}}</td>
                            <td style="padding-left: 20px; width: 80px;" ng-hide="service._elapsedTime == null">
                                {{service._elapsedTime | duration}}
                            </td>
                            <td style="padding-left: 20px;"
                                ng-show="service._status == 'playing'">
                                <div class="circleButton"
                                     ng-click="mobileConsole.pauseStoryboard(mobileConsole.topPage().node, service); $event.stopPropagation();">
                                    <i class="icon sl-pause-1"></i>
                                </div>
                            </td>
                            <!--td style="padding-left: 20px;"
                                ng-show="service._status == 'stopped' || !service._status">
                                <div class="circleButton"
                                     ng-click="startStoryboard(topPage().node, service); $event.stopPropagation();">
                                    <i class="fa fa-play"></i>
                                </div>
                            </td-->
                            <td style="padding-left: 20px;"
                                ng-show="service._status == 'paused'">
                                <div class="circleButton"
                                     ng-click="mobileConsole.playStoryboard(mobileConsole.topPage().node, service); $event.stopPropagation();">
                                    <i class="icon-sl-pause-1"></i>
                                </div>
                            </td>
                            <td style="padding-left: 20px;"
                                ng-show="service._status == 'playing' || service._status == 'paused'">
                                <div class="circleButton"
                                     ng-click="mobileConsole.stopStoryboard(mobileConsole.topPage().node, service); $event.stopPropagation();">
                                    <i class="icon-sl-stop-1"></i>
                                </div>
                            </td>
                        </tr>
                    </table>
                    <i class="icon sl-arrow-60 pull-right navigationIcon"></i>
                </div>
            </a>
            <a ng-repeat="device in mobileConsole.topPage().node.devices" class="list-group-item"
               ng-show="device.__type.tangible && !mobileConsole.isDeviceInGroups(mobileConsole.topPage().node, device)"
               ui-swipe-left="mobileConsole.pushDevicePage(device)">
                <div class="itemLabel" ng-click="mobileConsole.topPage().expandComponentUi(device)">{{device.label | splitcharacters:20}}
                </div>
                <table width="100%">
                    <tr style="vertical-align: middle;">
                        <td align="center">
                            <div ng-repeat="panel in [console()]">
                                <div class="componentPlugin" ng-include="mobileConsole.getComponentPluginPath(device)"
                                     ng-repeat="component in [device]"></div>
                            </div>
                        </td>
                    </tr>
                </table>
            </a>
            <a ng-repeat="actor in mobileConsole.topPage().actors"
               class="list-group-item" ng-show="!mobileConsole.isActorInGroups(mobileConsole.topPage().node, actor)"
               ui-swipe-left="mobileConsole.pushActorPage(actor)">
                <div class="itemLabel" ng-click="mobileConsole.topPage().expandComponentUi(actor)">{{actor.label | splitcharacters:20}}</div>
                <table
                        width="100%">
                    <tr style="vertical-align: middle;">
                        <td align="center">
                            <div ng-repeat="panel in [mobileConsole]">
                                <div class="componentPlugin" ng-include="mobileConsole.getComponentPluginPath(actor)"
                                     ng-repeat="component in [actor]"></div>
                            </div>
                        </td>
                    </tr>
                </table>
            </a>
            <a ng-repeat="sensor in mobileConsole.topPage().sensors"
               class="list-group-item" ng-show="!mobileConsole.isSensorInGroups(mobileConsole.topPage().node, sensor)"
               ui-swipe-left="mobileConsole.pushSensorPage(sensor)">
                <div class="itemLabel" ng-click="mobileConsole.topPage().expandComponentUi(sensor)">{{sensor.label | splitcharacters:20}}
                </div>
                <table width="100%">
                    <tr style="vertical-align: middle;">
                        <td align="center">
                            <div ng-repeat="panel in [console()]">
                                <div class="componentPlugin" ng-include="mobileConsole.getComponentPluginPath(sensor)"
                                     ng-repeat="component in [sensor]"></div>
                            </div>
                        </td>
                    </tr>
                </table>
            </a>
        </div>
    </div>
</div>
<div ui-content-for="modals">
    <div ng-include="'messageDialog.html'"></div>
    <div ng-include="'deviceAdvertisementDialog.html'"></div>
    <div class="modal modal-overlay" ui-if='componentPluginUi' ui-state='componentPluginUi'>
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="circleText pull-right" style="width: 20px;" ui-turn-off="componentPluginUi">
                        <div><i class="fa fa-times"></i></div>
                    </div>
                    <h1>{{topPage().component.label}}</h1>
                </div>
                <div class="modal-body" style="text-align: center;">
                    <div ng-repeat="panel in [mobileConsole]">
                        <div ng-include="mobileConsole.getComponentPluginPath(mobileConsole.topPage().component)"
                             ng-repeat="component in [mobileConsole.topPage().component]"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

